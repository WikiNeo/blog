---
title: 'jq -r'
tags: [Shell]
date: 2026-01-16
---

Letâ€™s break this shell line down **piece by piece**, from right to left, and then put it all together.

```sh
value=$(jq -r '.value // empty' "$CONFIG_FILE")
```

---

## 1ï¸âƒ£ `$( ... )` â€” command substitution

```sh
value=$( ... )
```

- `$(...)` means **run the command inside and capture its output**
- The output is assigned to the shell variable `value`

So whatever text the command prints to **stdout** becomes the value of `value`.

---

## 2ï¸âƒ£ `jq` â€” JSON processor

`jq` is a command-line tool used to **parse and query JSON files**.

Here it is used to extract a field from a JSON file.

---

## 3ï¸âƒ£ `-r` â€” raw output

```sh
jq -r ...
```

- `-r` means **raw output**
- Without `-r`, jq outputs JSON strings with quotes:

```json
"value"
```

- With `-r`, jq outputs plain text:

```text
value
```

This is important for shell scripting, because you usually **donâ€™t want quotes**.

---

## 4ï¸âƒ£ `'.value // empty'` â€” jq filter

This is the most important part.

### `.value`

- Accesses the key named `value` at the top level of the JSON

Example JSON:

```json
{
  "value": "hello"
}
```

`.value` â†’ `"hello"`

---

### `// empty` â€” fallback operator

- `//` is jqâ€™s **default / fallback operator**
- It means:

  > â€œIf the left side is null or missing, use the right side insteadâ€

`empty` is a jq builtin that outputs **nothing at all**.

So:

| JSON case         | Result           |
| ----------------- | ---------------- |
| `"value"` exists  | prints its value |
| `"value": null`   | prints nothing   |
| `"value"` missing | prints nothing   |

This avoids errors or `"null"` showing up.

---

## 5ï¸âƒ£ `"$CONFIG_FILE"` â€” input file

- `$CONFIG_FILE` is a shell variable containing a **path to a JSON file**
- The quotes protect against spaces in the filename

Example:

```sh
CONFIG_FILE=config.json
```

---

## ðŸ” Put it all together

This line means:

> **Read a JSON file, extract the `.value` field, print it as plain text if it exists, otherwise print nothing, and store the result in the shell variable `value`.**

---

## âœ… Example walkthrough

### JSON file

```json
{
  "value": "production"
}
```

### Result

```sh
value="production"
```

---

### JSON file (missing key)

```json
{
  "env": "production"
}
```

### Result

```sh
value=""
```

(no error, no `null`, just empty)

---

## ðŸ§  Why this pattern is popular

- Safe for missing keys
- No noisy `"null"`
- No extra quotes
- Works well with `set -e`
- Ideal for config files in CI/CD or scripts

---
