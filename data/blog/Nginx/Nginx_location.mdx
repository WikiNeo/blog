---
title: 'NGINX location'
tags: [NGINX]
date: 2026-02-13
---

In **NGINX**, a `location` block is used to define how requests for specific URIs should be processed. It is configured inside a `server` block.

---

## Basic Syntax

```nginx
server {
    listen 80;
    server_name example.com;

    location / {
        root /var/www/html;
        index index.html;
    }
}
```

---

# üîπ Location Matching Types

NGINX selects a `location` block based on specific matching rules.

## 1Ô∏è‚É£ Prefix Match (Most Common)

```nginx
location /images/ {
    root /data;
}
```

- Matches any request starting with `/images/`
- Example: `/images/logo.png`

---

## 2Ô∏è‚É£ Exact Match (`=`)

```nginx
location = /favicon.ico {
    access_log off;
}
```

- Matches **exactly** `/favicon.ico`
- Highest priority

---

## 3Ô∏è‚É£ Regex Match (`~` and `~*`)

### Case-Sensitive

```nginx
location ~ \.php$ {
    fastcgi_pass unix:/run/php/php8.1-fpm.sock;
}
```

### Case-Insensitive

```nginx
location ~* \.(jpg|jpeg|png|gif)$ {
    expires 30d;
}
```

---

## 4Ô∏è‚É£ Prefix Match with `^~`

```nginx
location ^~ /static/ {
    root /var/www/static;
}
```

- If this matches, **NGINX stops searching regex locations**
- Useful for performance optimization

---

# üîπ Location Selection Priority (Very Important)

NGINX follows this order:

1. `=` (Exact match)
2. `^~` (Prefix match, skip regex)
3. Regex (`~`, `~*`) ‚Äî first match wins
4. Longest prefix match (normal `/path/`)

---

# üîπ Example (API + Static + PHP)

```nginx
server {
    listen 80;
    server_name example.com;

    location = /health {
        return 200 "OK";
    }

    location ^~ /static/ {
        root /var/www/app;
    }

    location ~ \.php$ {
        include fastcgi_params;
        fastcgi_pass unix:/run/php/php8.1-fpm.sock;
    }

    location / {
        proxy_pass http://backend;
    }
}
```

---

# üîπ Common Use Cases in AWS / GCP

Since you're working with **AWS & GCP**, common scenarios include:

### Reverse Proxy to Backend (EC2, ECS, GKE)

```nginx
location /api/ {
    proxy_pass http://backend-service;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
}
```

### Health Check Endpoint (for ALB / GCP Load Balancer)

```nginx
location = /health {
    access_log off;
    return 200 "healthy";
}
```

### Serving Static Files from S3 (via proxy)

```nginx
location /assets/ {
    proxy_pass https://my-bucket.s3.amazonaws.com;
}
```

---
