---
title: 'How private key is used in digital certificate?'
tags: [Network]
date: 2025-11-12
---

---

## ğŸ” 1. The certificateâ€“key pair

A **certificate** (usually `.crt`, `.pem`, or `.cer`) contains:

- Your **public key**
- Identifying info (domain name, org, etc.)
- A **signature** from a Certificate Authority (CA) verifying that info

The corresponding **private key** (e.g. `server.key`) is generated first and **never leaves your control**.

**Together:**

```
Private key  <->  Public key (inside certificate)
```

---

## ğŸ§­ 2. How the private key is used

### (a) During **SSL/TLS handshake**

When a client (e.g., browser) connects:

1. The server sends its **certificate** (public key).
2. The client verifies the certificate (trust chain â†’ CA).
3. To prove it owns the certificate, the server must **sign a random challenge** using its **private key**.
4. The client checks the signature using the **public key** in the cert.

âœ… This proves:

- The server is the rightful owner of the certificate.
- The connection isnâ€™t being intercepted.

---

### (b) For **decryption**

In some handshake modes (like RSA key exchange), the serverâ€™s private key decrypts the â€œpremaster secretâ€ sent by the client.
Modern TLS (with ECDHE) usually doesnâ€™t use the private key for decryption directly â€” only for signing â€” which improves security (forward secrecy).

---

### (c) For **signing other certificates**

If the certificate is for a **Certificate Authority (CA)**, its private key is used to **sign** other certificates:

```
CA private key â†’ signs â†’ server certificates
```

This creates a **trust chain** (Root CA â†’ Intermediate CA â†’ Server).

---

## âš™ï¸ 3. Where it lives

- On web servers: `/etc/ssl/private/server.key` (permissions 600, owned by root)
- On client apps: inside secure key stores (macOS Keychain, Windows cert store)
- For cloud-managed certs: the cloud provider handles the private key (e.g., Google-managed certificates)

---

## ğŸ§¾ 4. Practical example

When using NGINX:

```nginx
server {
    listen 443 ssl;
    ssl_certificate     /etc/ssl/certs/server.crt;
    ssl_certificate_key /etc/ssl/private/server.key;
}
```

Here:

- `server.crt` = certificate (public key + CA signature)
- `server.key` = private key used for TLS handshakes

---

## ğŸš¨ 5. Security rule of thumb

- **Never share the private key** â€” not with clients, not with CAs.
- **Never commit it to Git** or cloud storage.
- If compromised â†’ regenerate key + reissue certificate immediately.

---
